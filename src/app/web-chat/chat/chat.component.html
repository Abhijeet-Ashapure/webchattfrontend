<div *ngIf="loader">
  <img src="assets/loader.gif" class="loaderClass" alt="">
</div>

<div class="sidebar-active" style="height: calc(100vh - 60px);">
  <div class="row pt-2" style="background-color: #fff;text-align: right;">
    <div class="dropdown dropMenu dropDownwidth dropdownStyle d-flex align-items-center ml-auto mr-5">
      <div class="usernamestyle">{{userData}}</div>
      <a class="btn btn-secondary dropdown-toggle ml-3"
        style="height: 42px !important;width: 42px !important;min-width: 42px;border-radius: 50%;padding: 12px 15px;"
        id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i
          class="fa fa-bars"></i></a>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
        <div class="d-flex align-items-center topImage">
          <img src="assets/img/logoChat.png" />
          <a (click)="logout()" class="ml-auto">Logout</a>
        </div>
        <div class="profileName pt-3 pb-3 brdrBtm clearfix">
          <div class="media" data-toggle="modal" data-target="#exampleModaltest">
            <img class="mr-3" src="assets/img/chat1.jpg" alt="Generic placeholder image">
            <div class="media-body">
              <h5 class="mt-0">{{userData}}</h5>
              <p class="mb-0">{{userEmail}}</p>
            </div>
          </div>
        </div>
        <div *ngIf="userType && userType !== 'guestUser'" class="pt-3 pb-3 brdrBtm">
          <div style="cursor: pointer;" (click)="copy(invitationLink)" class="d-flex align-item-center">
            <p class="mb-0">Invitation link</p>
            <i style="color: #1c9dea;" class="fa fa-copy ml-auto"></i>
          </div>
        </div>
        <div class="pt-3 pb-3 brdrBtm">
          <p class="mb-0">Starred Messages</p>
        </div>
        <div class="pt-3 pb-3 brdrBtm">
          <p class="mb-0">About Us</p>
        </div>
        <div class="pt-3 pb-3 brdrBtm">
          <p class="mb-0">Terms & Conditions</p>
        </div>
        <div class="pt-3 pb-3 brdrBtn">
          <div class="main">
            <div class="innerdiv d-flex align-items-center">
              <div class="ml-auto d-flex align-items-center pr-3">
                <span>Light</span>
                <label class="switch">
                  <input type="checkbox" (click)="toggle()">
                  <span class="slider round"></span>
                </label>
                <span>Dark</span>
                <span class="form-inline languageSelect">
                  <select class="form-control" #selectedLang (change)="switchLang(selectedLang.value)">
                    <option *ngFor="let language of translate.getLangs()" [value]="language"
                      [selected]="language === translate.currentLang">
                      {{ language }}
                    </option>
                  </select>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>



  <div class="chitchat-container  sidebar-toggle">

    <aside *ngIf="!isChatToggle" class="chitchat-left-sidebar  left-disp">
      <div class="recent-default dynemic-sidebar active">
        <div class="chat custom-scroll">
          <div class="theme-tab tab-sm chat-tabs">
            <div class="tab-content" id="myTabContent">
              <div class="tab-pane fade show active" id="chat" role="tabpanel" aria-labelledby="chat-tab">
                <div class="theme-tab">
                  <div class="tab-content" id="myTabContent1">
                    <!-- *ngIf="!inviteUser" -->
                    <div class="tab-pane fade show active" id="direct" role="tabpanel" aria-labelledby="direct-tab">
                      <div class="searchBar">
                        <div class="form-group posRel">
                          <input class="form-control-plaintext" [(ngModel)]="searchUser" type="search"
                            (keyup)="checkUserExist()" placeholder="Search..">
                          <span><i class="fa fa-search"></i></span>
                        </div>
                      </div>
                      <div *ngIf="!routeId" class="d-flex align-items-center mt-2 mb-2">
                        <img src="assets/img/logoChat.png" />
                        <a class="btn btn-primary button-effect ml-3"  (click)="createGroup()"
                          data-toggle="modal" data-target="#exampleModal2">Create Chat Group</a>
                        <!-- <a class="btn button-effect btn-signup">Invite</a> -->
                      </div>
                      <!-- Modal -->
                      <div class="modal fade" id="exampleModaltest" tabindex="-1" role="dialog"
                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                          <div class="modal-content">
                            <div class="modal-header modalHeaderSection">
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body">
                              <div class="text-center">
                                <div class="modalPicture">
                                  <img src="assets/img/chat1.jpg" />
                                </div>
                                <div class="editIcoon">
                                  <a><i class="fa fa-pencil"></i></a>
                                </div>
                                <div class="modalName text-center">
                                  <h3>{{userData}}</h3>
                                </div>
                                <div class="profileList mt-4">
                                  <h3 class="text-left">Share Profile</h3>
                                </div>
                                <div class="profileList mt-4">
                                  <h5>Profile</h5>
                                  <div class="d-flex align-items-center profileLlist">
                                    <h4 class="mb-0">WebChat Name</h4>
                                    <p class="mb-0 ml-auto">live:{{userData}}</p>
                                  </div>
                                  <div class="d-flex align-items-center profileLlist">
                                    <h4 class="mb-0">Email Address</h4>
                                    <p class="mb-0 ml-auto">{{userEmail}}</p>
                                  </div>
                                </div>
                                <div class="profileList mt-4 brdrBtmNone">
                                  <h5>Help and Feedback</h5>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- Modal -->
                      <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog"
                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                          <div class="modal-content">
                            <div class="modal-header">
                              <div class="d-flex align-items-center w-100">
                                <h5 class="modal-title" id="exampleModalLabel"><a data-toggle="modal"
                                    data-target="#exampleModal2" data-dismiss="modal"><i
                                      class="fa fa-long-arrow-left mr-2"></i></a>Group Chat</h5>
                              </div>
                              <h5 class="modal-title" id="exampleModalLabel">New Group Chat</h5>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                              </button>
                            </div>
                            <div class="modal-body">
                              <div class="profileImgge text-center">
                                <div class="log_div">
                                  <div class="prfle-img-sgnup">
                                    <img [src]="groupImage" id="pImg"
                                      onerror="this.onerror=null;this.src='assets/img/avatar.jpg'">
                                  </div>
                                  <div class="text-center upload_pic_in_album">
                                    <input id="file-1" id="pImg" #filepicker type="file"
                                      (change)="selectProfileImage($event)">
                                    <label for="file-1" (click)="filepicker.click()">
                                      <span class="fa fa-camera fa-2x"></span></label>
                                  </div>
                                  <div id="profileImage-err"> </div>
                                </div>
                              </div>
                              <div class="form-group">
                                <label class="col-form-label">Group Name</label>
                                <input class="form-control" type="text" [(ngModel)]="room"
                                  placeholder="Enter your room name" default=''>
                              </div>
                            </div>
                            <div class="modal-footer d-flex align-items-center justify-content-center">
                              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                              <!-- data-toggle="modal" data-target="#exampleModal2" data-dismiss="modal" [disabled]="room == '' || room == null" -->
                              <button type="button" class="btn btn-primary" data-dismiss="modal"
                                (click)="joinGroup(room,selectedUserGroup)">Next</button>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--second modal -->
                      <div class="modal fade" id="exampleModal2" tabindex="-1" role="dialog"
                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                        <div class="modal-dialog" role="document">
                          <div class="modal-content">
                            <div class="modal-header">
                              <div class="d-flex align-items-center w-100">
                                <button type="button" class="ml-auto btn doneBtn"
                                  [disabled]="selectedUserGroup.length == 0" data-toggle="modal"
                                  data-target="#exampleModal" data-dismiss="modal">Next</button>
                              </div>
                            </div>
                            <div class="modal-body">
                              <div class="searchBar mt-2">
                                <div class="form-group posRel">
                                  <input class="form-control-plaintext" type="search" [(ngModel)]="searchToAddGroup"
                                    placeholder="Search..">
                                  <span><i class="fa fa-search"></i></span>
                                </div>
                              </div>
                              <div class="circleBlock pt-1 pb-3">
                                <div class="flexItemObject" *ngFor="let user of selectedUserGroup; let i=index;">
                                  <div class="imageSection">
                                    <img src="assets/img/chat1.jpg" />
                                    <a (click)="removeSelectedUser(i)"><i class="fa fa-times"></i></a>
                                    <h6 class="mb-0">{{user.userName}}</h6>
                                  </div>
                                </div>
                              </div>
                              <div class="clearfix"></div>
                              <div class="listingChat pt-3">
                                <!--  | search:searchTerm  -->

                                <div *ngFor="let user of AllUser | filter:searchToAddGroup;let i=index;">
                                  <div *ngIf="user.userType !='guestUser'"
                                    class="d-flex align-items-center listingName mb-3">
                                    <div class="d-flex align-items-center imgName">
                                      <img src="assets/img/chat1.jpg" />
                                      <h5>
                                        {{user.userName}}
                                      </h5>
                                    </div>
                                    <div class="ml-auto">
                                      <p class="mb-0">
                                        <input type="checkbox" id="{{'test'+i}}" (change)="addUserGroup($event,user)"
                                          name="checkbox-group" [checked]="checkselected(user)">
                                        <label for="{{'test'+i}}"></label>
                                      </p>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!--/second modal -->
                      <ul class="chat-main">
                        <!-- | search:searchTerm -->
                        <div *ngIf="!routeId">
                          <div *ngFor="let room of groupNames">
                            <div *ngFor="let roomMember of room.memberId">
                              <li *ngIf="userId == room.adminId || userId == roomMember._id " style="cursor: pointer;"
                                class="active" data-to="chatting">
                                <div class="chat-box" (click)="OpenChatRoomBox(room._id)">
                                  <div class="profile imgName ">
                                    <img class="bg-img" src="{{room.groupImg}}" alt="Avatar"
                                      style="height: 50px; width: 55px;"
                                      onerror="this.onerror=null;this.src='assets/img/avatar.jpg'" />
                                  </div>
                                  <div class="details">
                                    <h5>{{room.groupName}}</h5>
                                  </div>
                                  <div class="date-status"><i class="ti-pin2"></i>
                                    <h6>{{room.created_at | date: 'dd/MM/YY'}}</h6>
                                    <h6 class="font-success status"> {{room.isMessageRead ? 'unseen' : 'seen'}}</h6>
                                  </div>
                                </div>
                              </li>
                            </div>
                          </div>
                        </div>

                        <!-- AllUser -->
                        <div>
                          <div *ngFor="let user of  allUserWithChatHistory | filter:searchUser">
                            <li *ngIf="userId != user._id" class="active" data-to="chatting" style="cursor: pointer;">
                              <div class="chat-box" (click)="OpenChatBox(user._id); checkOnline(user._id)">
                                <div class="profile imgName"><img class="bg-img" src="assets/img/chat1.jpg"
                                    alt="Avatar" /></div>
                                <div class="details">
                                  <h5>{{user.userName}}</h5>

                                  <!-- <h6>Hi, i am josephin. How are you.. ! There are many variations of passages.</h6> -->
                                </div>
                                <div class="m-auto">
                                  <div *ngIf="user.isOnline; else UserOffline" class="badge badge-success mt-3">Online
                                  </div>
                                  <ng-template #UserOffline>
                                    <div class="badge badge-secondary mt-3">Offline</div>
                                  </ng-template>
                                </div>
                                <div class="date-status">

                                  <i class="ti-pin2"></i>
                                  <h6>{{user.updated_at | date: 'dd/MM/YY'}}</h6>
                                  <h6 class="font-success status"> {{user.isMessageRead ? 'unseen' : 'seen'}} <i
                                      *ngIf="user.isMessageRead" class="fa fa-envelope"
                                      style="font-size:18px;color:red"></i></h6>
                                </div>
                              </div>
                            </li>
                          </div>
                        </div>
                        <div *ngIf="searchUser && userType !='guestUser'">
                          <div *ngFor="let user of  AllUser | filter:searchUser">
                            <li *ngIf="userId != user._id" class="active" data-to="chatting"
                              style="cursor: pointer;background-color: #1c9dea;">
                              <div class="chat-box" (click)="OpenChatBox(user._id)">
                                <div class="profile imgName"><img class="bg-img" src="assets/img/chat1.jpg"
                                    alt="Avatar" />
                                </div>
                                <div class="details">
                                  <h5>{{user.userName}}</h5>
                                  <!-- <h6>Hi, i am josephin. How are you.. ! There are many variations of passages.</h6> -->
                                </div>
                                <div class="date-status"><i class="ti-pin2"></i>
                                  <h6>{{user.updated_at | date: 'dd/MM/YYYY'}}</h6>
                                  <h6 class="font-success status"> {{user.isMessageRead ? 'unseen' : 'seen'}} <i
                                      *ngIf="user.isMessageRead" class="fa fa-envelope"
                                      style="font-size:18px;color:red"></i></h6>
                                </div>
                              </div>
                            </li>
                          </div>
                        </div>

                        <div *ngIf="searchUser && userType =='guestUser'">
                          <div *ngFor="let user of  showGuestUserList">
                            <li *ngIf="userId != user._id" class="active" data-to="chatting"
                              style="cursor: pointer;background-color: #1c9dea;">
                              <div class="chat-box" (click)="OpenChatBox(user._id)">
                                <div class="profile imgName"><img class="bg-img" src="assets/img/chat1.jpg"
                                    alt="Avatar" />
                                </div>
                                <div class="details">
                                  <h5>{{user.userName}}</h5>
                                  <!-- <h6>Hi, i am josephin. How are you.. ! There are many variations of passages.</h6> -->
                                </div>
                                <div class="date-status"><i class="ti-pin2"></i>
                                  <h6>{{user.updated_at | date: 'dd/MM/YYYY'}}</h6>
                                  <h6 class="font-success status"> {{user.isMessageRead ? 'unseen' : 'seen'}} <i
                                      *ngIf="user.isMessageRead" class="fa fa-envelope"
                                      style="font-size:18px;color:red"></i></h6>
                                </div>
                              </div>
                            </li>
                          </div>
                        </div>

                        <div *ngIf="showInvite">
                          <li class="active" data-to="chatting" style="cursor: pointer;">
                            <div class="chat-box">
                              <div class="profile imgName"><img class="bg-img" src="assets/img/chat1.jpg"
                                  alt="Avatar" />
                              </div>
                              <div class="details">
                                <h5>{{searchUser}}</h5>
                              </div>
                              <div class="date-status"><i class="ti-pin2"></i>
                                <button class="btn btn-primary button-effect signpbtn" (click)="sendInvite(searchUser)"
                                  style="padding: 10px 10px !important;position: absolute;right: 15px;">Invite
                                  Friends!</button>
                              </div>
                            </div>
                          </li>
                        </div>
                        <br><br><br>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </aside>
    <div class="" style="background-color: #fff;">
      <a class="icon-btn btn-white bg-primary text-white button-effect" style="margin-top: 15px;"><i class="fa fa-bars"
          aria-hidden="true" (click)="isChatToggle = !isChatToggle"></i>
      </a>
    </div>


    <div class="chitchat-main  small-sidebar posRel" id="content">
      <!--dropdown-->
      <div class="d-flex align-items-center mt-2">
        <div *ngIf="User || room || inviteEmail" class="contact-details">
          <div class="row d-flex align-items-center">
            <div class="col-7">
              <div class="media left">
                <div class="media-left mr-3">
                  <div [class.online]="isUsaerOnline == true" class="profile menu-trigger"><img class="bg-img"
                      src="assets/img/chat1.jpg" alt="Avatar" /></div>
                </div>
                <div class="media-body">
                  <h5>{{User?.userName? User?.userName: room?.groupName? room?.groupName: inviteEmail ? inviteEmail :
                    ''}}</h5>
                  <div *ngIf="isUsaerOnline; else UserOffline" class="badge badge-success mt-3">Online</div>
                  <ng-template #UserOffline>
                    <div class="badge badge-secondary mt-3">Offline</div>
                  </ng-template>
                </div>
              </div>
            </div>
            <div class="col">
              <ul class="calls text-right">
                <li class="chat-friend-toggle">
                  <a class="icon-btn btn-white bg-primary text-white button-effect outsidedropdown-toggle"
                    id="userDropdownMenuButton" data-toggle="dropdown" data-tippy-content="Quick action"><i
                      class="fa fa-bars" aria-hidden="true"></i>
                  </a>
                  <div class="dropdown-menu" aria-labelledby="userDropdownMenuButton">
                    <div>
                      <ul *ngIf="roomUser; else UserMenu">
                        <li class="d-flex align-items-center actionList" data-toggle="modal" href="#leaveModal">
                          <a class="icon-btn btn-outline-danger button-effect btn-sm"><i class="fa fa-trash"
                              aria-hidden="true"></i></a>
                          <h5>Leave Group</h5>
                        </li>
                        <li (click)="copy(shareGroupLink+room._id)" class="d-flex align-items-center actionList">
                          <a class="icon-btn btn-outline-danger button-effect btn-sm"><i class="fa fa-copy"
                              aria-hidden="true"></i></a>
                          <h5>Copy Group Link</h5>
                        </li>
                      </ul>
                      <ng-template #UserMenu>
                        <ul>
                          <li class="d-flex align-items-center actionList" data-toggle="modal"
                            data-target="#deleteConversationModal">
                            <a class="icon-btn btn-outline-danger button-effect btn-sm"><i class="fa fa-trash"
                                aria-hidden="true"></i></a>
                            <h5>Delete Conversation History</h5>
                          </li>
                          <li *ngIf="userMessage[0]?.chatEnable == 1" (click)="disableChat(User._id)"
                            class="d-flex align-items-center actionList">
                            <a class="icon-btn btn-outline-danger button-effect btn-sm"><i class="fa fa-ban"
                                aria-hidden="true"></i></a>
                            <h5>Disable Chat</h5>
                          </li>
                          <li *ngIf="userMessage[0]?.chatEnable == 0" (click)="enableChat(User._id)"
                            class="d-flex align-items-center actionList">
                            <a class="icon-btn btn-outline-danger button-effect btn-sm"><i class="fa fa-ban"
                                aria-hidden="true"></i></a>
                            <h5>Enable Chat</h5>
                          </li>
                          <li class="d-flex align-items-center actionList" data-toggle="modal"
                            data-target="#emailChatModal">
                            <a class="icon-btn btn-outline-danger button-effect btn-sm"><i class="fa fa-envelope-o"
                                aria-hidden="true"></i></a>
                            <h5>Email chat transcript</h5>
                          </li>
                        </ul>
                      </ng-template>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>

      </div>

      <!--/dropdown-->
      <!-- if room user  room-->
      <div *ngIf="User" class="chat-content tabto active navbar-fixed-top">
        <div class="messages custom-scroll active" id="chating">
          <div class="contact-chat mb-5" id="chatConversation">
            <ul *ngFor="let message of userMessage">
              <!-- <div *ngIf="message.isDeleteFromSender==0"> </div> -->
              <li *ngIf="userId == message.senderId; else elsePart" class="replies">
                <div class="media">
                  <div class="profile mr-4"><img class="bg-img" style="border-radius: 50%;" src="assets/img/chat1.jpg"
                      alt="Avatar" /></div>
                  <div class="media-body">
                    <div class="contact-name">
                      <h5>{{userData}}</h5>
                      <h6>{{message.created_at | date:'short'}}</h6>
                      <ul class="msg-box">
                        <li class="msg-setting-main">
                          <h5 *ngIf="validURL(message.message); else textMsg">
                            <a target="_blank" href="{{message.message}}">{{message.message}}</a>
                          </h5>
                          <ng-template #textMsg>
                            <h5>{{message.message}}</h5>
                          </ng-template>
                        </li>
                        <li *ngIf="message.file"><img class="bg-img" src="{{message.file}}" alt="Avatar" /></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </li>
              <ng-template #elsePart>
                <!-- <div *ngIf="message.isDeleteFromReceiver==0"></div> -->
                <li class="sent">
                  <div class="media">
                    <div class="profile mr-4"><img class="bg-img" style="border-radius: 50%;" src="assets/img/chat1.jpg"
                        alt="Avatar" /></div>
                    <div class="media-body">
                      <div class="contact-name">
                        <h5>{{User?.userName}}</h5>
                        <h6>{{message.created_at | date:'short'}}</h6>
                        <ul class="msg-box">
                          <li class="msg-setting-main">
                            <h5 *ngIf="validURL(message.message); else textMsg2">
                              <a style="color: white !important;" href="{{message.message}}">{{message.message}}</a>
                            </h5>
                            <ng-template #textMsg2>
                              <h5>{{message.message}}</h5>
                            </ng-template>
                          </li>
                          <li *ngIf="message.file"><img class="bg-img" src="{{message.file}}" alt="Avatar" /></li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </li>
              </ng-template>
            </ul>
            <ul class="chatappend" id="message-list">
            </ul>
            <ul *ngIf="userMessage[0]?.chatEnable == 0">
              <li class="replies">user disblle the chat</li>
            </ul>
            <div *ngIf="!userId && routeName">
              <form class="form1" [formGroup]="guestLoginForm">
                <div class="form-group">
                  <label class="col-form-label" for="inputEmail3">Email Address</label>
                  <input class="form-control" id="inputEmail3" type="email" formControlName="email"
                    placeholder="Enter Email Address">
                  <div
                    *ngIf="(guestLoginForm.get('email')?.invalid && guestLoginForm.get('email')?.touched) || guestLoginForm.get('email')?.dirty">
                    <small *ngIf="guestLoginForm.get('email')?.errors?.required" class="text-danger">Email
                      is
                      required</small>
                    <small *ngIf="guestLoginForm.get('email')?.errors?.pattern" class="text-danger">Please
                      provide
                      a valid email address</small>
                  </div>
                </div>
                <div class="form-group">
                  <label class="col-form-label" for="inputPassword3">Name</label><span> </span>
                  <input class="form-control" id="inputPassword3" formControlName="userName" type="text"
                    placeholder="Enter User Name">
                  <div
                    *ngIf="(guestLoginForm.get('userName')?.invalid && guestLoginForm.get('userName')?.touched) || guestLoginForm.get('userName')?.dirty">
                    <small *ngIf="guestLoginForm.get('userName')?.errors?.required" class="text-danger">Name is
                      required</small>
                  </div>
                </div>
                <div class="d-flex align-items-center">
                  <div class="form-group">
                    <div class="buttons"><button type="button" class="btn btn-primary button-effect"
                        [disabled]="guestLoginForm.invalid" (click)="guestUserLogin(guestLoginForm.value)">Guest
                        Login</button> </div>
                  </div>
                </div>
              </form>
            </div>
            <br><br><br>
          </div>
          <br>
          <br>
        </div>
        <div class="messages custom-scroll" id="group_blank">
          <div class="contact-details">
            <div class="row">
              <div class="col">
                <div class="media left">
                  <div class="media-left mr-3">
                    <div class="profile online menu-trigger"><img class="bg-img" src="assets/img/chat1.jpg"
                        alt="Avatar" /></div>
                  </div>
                  <div class="media-body">
                    <h5>Family Ties</h5>
                    <h6>Last Seen 2 hours</h6>
                  </div>
                </div>
              </div>
              <div class="col">
                <ul class="calls text-right">
                  <li><a class="icon-btn btn-light button-effect" data-tippy-content="Quick Audio Call"
                      data-toggle="modal" data-target="#confercall"><i data-feather="phone"></i></a></li>
                  <li><a class="icon-btn btn-light button-effect" data-tippy-content="Quick Video Call"
                      data-toggle="modal" data-target="#confvideocl"><i data-feather="video"></i></a></li>
                  <li class="chat-friend-toggle"><a class="icon-btn btn-light bg-transparent button-effect outside"
                      data-tippy-content="Quick action"><i data-feather="more-vertical"></i></a>
                    <div class="chat-frind-content">
                      <ul>
                        <li><a class="icon-btn btn-outline-primary button-effect btn-sm"><i data-feather="user"></i></a>
                          <h5>profile</h5>
                        </li>
                        <li><a class="icon-btn btn-outline-success button-effect btn-sm"><i
                              data-feather="plus-circle"></i></a>
                          <h5>archive</h5>
                        </li>
                        <li><a class="icon-btn btn-outline-danger button-effect btn-sm"><i
                              data-feather="trash-2"></i></a>
                          <h5>delete</h5>
                        </li>

                        <li><a class="icon-btn btn-outline-light button-effect btn-sm"><i data-feather="slash"></i></a>
                          <h5>block</h5>
                        </li>
                      </ul>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="contact-chat">
            <div class="rightchat animat-rate">
              <div class="bg_circle">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
              </div>
              <div class="cross"></div>
              <div class="cross1"></div>
              <div class="cross2"></div>
              <div class="dot"></div>
              <div class="dot1"> </div>
            </div>
          </div>
          <div class="call-list-center">
            <div class="animated-bg"><i></i><i></i><i></i></div>
            <p>Select a chat to read messages</p>
          </div>
        </div>

      </div>
      <div *ngIf="roomUser" class="chat-content tabto active navbar-fixed-top">
        <div class="messages custom-scroll active" id="chating">
          <div class="contact-chat">
            <ul *ngFor="let message of groupMessage">
              <li *ngIf="userId == message.senderId?._id; else elsePart" class="replies">
                <div class="media">
                  <div class="profile mr-4"><img class="bg-img" style="border-radius: 50%;" src="assets/img/chat1.jpg"
                      alt="Avatar" /></div>
                  <div class="media-body">
                    <div class="contact-name">
                      <h5>{{userData}}</h5>
                      <h6>{{message.created_at | date:'short'}}</h6>
                      <ul class="msg-box">
                        <li class="msg-setting-main">
                          <h5>{{message.message}}</h5>
                        </li>
                        <li *ngIf="message.file"><img class="bg-img" src="{{message.file}}" alt="Avatar" /></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </li>
              <ng-template #elsePart>
                <li class="sent">
                  <div class="media">
                    <div class="profile mr-4"><img class="bg-img" style="border-radius: 50%;" src="assets/img/chat1.jpg"
                        alt="Avatar" /></div>
                    <div class="media-body">
                      <div class="contact-name">
                        <h5>{{message.senderId?.userName}}</h5>
                        <h6>{{message.created_at | date:'short'}}</h6>
                        <ul class="msg-box">
                          <li class="msg-setting-main">
                            <h5>{{message.message}}</h5>
                          </li>
                          <li *ngIf="message.file"><img class="bg-img" src="{{message.file}}" alt="Avatar" /></li>
                        </ul>
                      </div>
                    </div>
                  </div>
                </li>
              </ng-template>
            </ul>
            <ul class="chatappend" id="message-list-group">
            </ul>
            <!-- <div *ngIf="shareGroupId" style="text-align: center;">
              <button (click)="editGroup(shareGroupId, userId)" type="button" class="btn btn-primary">joinGroup</button>
            </div> -->
          </div>
        </div>
        <div class="messages custom-scroll" id="group_blank">
          <div class="contact-details">
            <div class="row">
              <div class="col">
                <div class="media left">
                  <div class="media-left mr-3">
                    <div class="profile online menu-trigger"><img class="bg-img" src="assets/img/chat1.jpg"
                        alt="Avatar" /></div>
                  </div>
                  <div class="media-body">
                    <h5>Family Ties</h5>
                    <h6>Last Seen 2 hours</h6>
                  </div>
                </div>
              </div>
              <div class="col">
                <ul class="calls text-right">
                  <li><a class="icon-btn btn-light button-effect" data-tippy-content="Quick Audio Call"
                      data-toggle="modal" data-target="#confercall"><i data-feather="phone"></i></a></li>
                  <li><a class="icon-btn btn-light button-effect" data-tippy-content="Quick Video Call"
                      data-toggle="modal" data-target="#confvideocl"><i data-feather="video"></i></a></li>
                  <li class="chat-friend-toggle"><a class="icon-btn btn-light bg-transparent button-effect outside"
                      data-tippy-content="Quick action"><i data-feather="more-vertical"></i></a>
                    <div class="chat-frind-content">
                      <ul>
                        <li><a class="icon-btn btn-outline-primary button-effect btn-sm"><i data-feather="user"></i></a>
                          <h5>profile</h5>
                        </li>
                        <li><a class="icon-btn btn-outline-success button-effect btn-sm"><i
                              data-feather="plus-circle"></i></a>
                          <h5>archive</h5>
                        </li>
                        <li><a class="icon-btn btn-outline-danger button-effect btn-sm"><i
                              data-feather="trash-2"></i></a>
                          <h5>delete</h5>
                        </li>
                        <li><a class="icon-btn btn-outline-light button-effect btn-sm"><i data-feather="slash"></i></a>
                          <h5>block</h5>
                        </li>
                      </ul>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="contact-chat">
            <div class="rightchat animat-rate">
              <div class="bg_circle">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
              </div>
              <div class="cross"></div>
              <div class="cross1"></div>
              <div class="cross2"></div>
              <div class="dot"></div>
              <div class="dot1"> </div>
            </div>
          </div>
          <!-- <img src="../assets/images/chat.png" alt="" /> -->
          <div class="call-list-center">
            <div class="animated-bg"><i></i><i></i><i></i></div>
            <p>Select a chat to read messages</p>
          </div>
        </div>
        <div class="message-input">
          <div class="wrap emojis-main d-flex align-items-center">
            <div class="messageBox">
              <input class="setemoj" id="setemoj"
                style="width: 100%;line-height: 2.5rem !important; border: 1px solid !important; border-radius: 7px !important; padding: 0px 10px;"
                type="text" [(ngModel)]="message" (keyup.enter)="sendRoomMessage(message)"
                placeholder="Type a message..." />
            </div>
            <div class="msgBoxButton d-flex align-items-center" style="width: 10%;">
              <div class="uploadicon ml-2">
                <input id="groupFile" type="file" (change)="selectGroupFile($event)" [(ngModel)]="groupFile">
                <label for="groupFile" style="margin-bottom: 0px !important;">
                  <i class="fa fa-camera"></i></label>
              </div>
              <button type="button" class="submit icon-btn btn-primary mr-2"
                [disabled]="message == '' || message == null" (click)="sendRoomMessage(message)"><i
                  class="fa fa-paper-plane" aria-hidden="true"></i></button>
            </div>
          </div>
        </div>
      </div>
      <div *ngIf="User" class="message-input">
        <div *ngIf="userMessage[0]?.chatEnable == 1 || userMessage[0]?.chatEnable == undefined "
          class="wrap emojis-main d-flex align-items-center">
          <div class="messageBox">
            <input class="setemoj" id="setemoj"
              style="width: 100%;line-height: 2.5rem !important; border: 1px solid !important; border-radius: 7px !important; padding: 0px 10px;"
              type="text" [(ngModel)]="message" (keyup.enter)="sendMessage(message)" placeholder="Type a message..." />
          </div>
          <div class="msgBoxButton d-flex align-items-center" style="width: 10%;">
            <div class="uploadicon ml-2">
              <input *ngIf="!isUpload" id="file" type="file" (change)="selectFile($event)" [(ngModel)]="file">
              <label for="file" style="margin-bottom: 0px !important;">
                <i class="fa fa-camera"></i></label>
            </div>
            <!-- disabled disabled="disabled"-->
            <button type="button" class="submit icon-btn btn-primary mr-2" [disabled]="message == '' || message == null"
              (click)="sendMessage(message)"><i class="fa fa-paper-plane" aria-hidden="true"></i></button>
          </div>
        </div>
      </div>
      <div *ngIf="inviteUser" class="chat-content tabto active navbar-fixed-top">
        <div class="messages custom-scroll active" id="chating">
          <div class="contact-chat">
            <ul class="chatappend" id="message-list-invite">
              <li class="inviteboxStype">This user is not available on webchat tool but you can still chat with him.
                <br>write a message to {{inviteEmail}} and this would be sent on his email address
              </li>
            </ul>
          </div>
        </div>
        <div class="messages custom-scroll" id="group_blank">
          <div class="contact-details">
            <div class="row">
              <div class="col">
                <div class="media left">
                  <div class="media-left mr-3">
                    <div class="profile online menu-trigger"><img class="bg-img" src="assets/img/chat1.jpg"
                        alt="Avatar" /></div>
                  </div>
                  <div class="media-body">
                    <h5>Family Ties</h5>
                    <h6>Last Seen 2 hours</h6>
                  </div>
                </div>
              </div>
              <div class="col">
                <ul class="calls text-right">
                  <li><a class="icon-btn btn-light button-effect" data-tippy-content="Quick Audio Call"
                      data-toggle="modal" data-target="#confercall"><i data-feather="phone"></i></a></li>
                  <li><a class="icon-btn btn-light button-effect" data-tippy-content="Quick Video Call"
                      data-toggle="modal" data-target="#confvideocl"><i data-feather="video"></i></a></li>
                  <li class="chat-friend-toggle"><a class="icon-btn btn-light bg-transparent button-effect outside"
                      data-tippy-content="Quick action"><i data-feather="more-vertical"></i></a>
                    <div class="chat-frind-content">
                      <ul>
                        <li><a class="icon-btn btn-outline-primary button-effect btn-sm"><i data-feather="user"></i></a>
                          <h5>profile</h5>
                        </li>
                        <li><a class="icon-btn btn-outline-success button-effect btn-sm"><i
                              data-feather="plus-circle"></i></a>
                          <h5>archive</h5>
                        </li>
                        <li><a class="icon-btn btn-outline-danger button-effect btn-sm"><i
                              data-feather="trash-2"></i></a>
                          <h5>delete</h5>
                        </li>
                        <li><a class="icon-btn btn-outline-light button-effect btn-sm"><i data-feather="slash"></i></a>
                          <h5>block</h5>
                        </li>
                      </ul>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="contact-chat">
            <div class="rightchat animat-rate">
              <div class="bg_circle">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
              </div>
              <div class="cross"></div>
              <div class="cross1"></div>
              <div class="cross2"></div>
              <div class="dot"></div>
              <div class="dot1"> </div>
            </div>
          </div>
          <!-- <img src="../assets/images/chat.png" alt="" /> -->
          <div class="call-list-center">
            <div class="animated-bg"><i></i><i></i><i></i></div>
            <p>Select a chat to read messages</p>
          </div>
        </div>
        <div class="message-input">
          <div class="wrap emojis-main d-flex align-items-center">
            <div style="width: 55%;">
              <input class="setemoj" id="setemoj"
                style="width: 100%;line-height: 2.5rem !important; border: 1px solid !important; border-radius: 7px !important; padding: 0px 10px;"
                type="text" [(ngModel)]="message" (keyup.enter)="sendInviteEmail(message)"
                placeholder="Type a message..." />
            </div>
            <div class="msgBoxButton ml-3" style="width: 10%;">
              <button type="button" class=" btn-primary sendEmail mr-2" [disabled]="message == '' || message == null"
                (click)="sendInviteEmail(message)">
                Send Email
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<div id="leaveModal" class="modal fade webChatModal">
  <div class="modal-dialog modal-confirm">
    <div class="modal-content">
      <div class="modal-header flex-column">
        <div class="icon-box ml-auto" class="close" data-dismiss="modal">
          <i class="material-icons">&#xE5CD;</i>
        </div>
        <h4 class="modal-title w-100 text-center">Are you sure?</h4>
        <!-- <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button> -->
      </div>
      <div class="modal-body text-center">
        <p>Do you really want to leave this room?</p>
      </div>
      <div class="modal-footer justify-content-center">
        <!-- (click)="leaveGroup(deleteLeaveId)" -->
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="leaveGroup()">Yes,
          Leave Room!</button>
      </div>
    </div>
  </div>
</div>

<!--email chat Modal  -->
<div class="modal fade webChatModal" id="emailChatModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Email Chat</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <input type="text" class="form-control" placeholder="Enter Email" #email>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" (click)="emailChatTranscript(email.value)">Email Chat
          Conversation</button>
      </div>
    </div>
  </div>
</div>

<div id="deleteConversationModal" class="modal fade webChatModal">
  <div class="modal-dialog modal-confirm">
    <div class="modal-content">
      <div class="modal-header flex-column">
        <div class="ml-auto" class="close" data-dismiss="modal">
          <i class="fa fa-close"></i>
        </div>
        <h4 class="modal-title w-100">Delete Chat</h4>
        <!-- <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button> -->
      </div>
      <div class="modal-body text-center">
        <p>Are you sure you want to delete this conversation?</p>
      </div>
      <div class="modal-footer justify-content-center">
        <!-- (click)="leaveGroup(deleteLeaveId)" -->
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="deleleConverstion()">Yes,
          Delete It!</button>
      </div>
    </div>
  </div>
</div>